<!doctype html>

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Validador de ruts.</title>

<p>
  Copie y pegue un texto que contenga ruts.
  Yo le dir&eacute; si est&aacute;n correctos.
</p>

<textarea id="entrada" placeholder="Pegue aqu&iacute;">
</textarea>
<br>

<input id="validar" value="Validar" type="button">
<input id="borrar"  value="Borrar"  type="button">

<p id="reporte">
</p>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
</script>

<script>
    $("#borrar").on("click", function() {
        $("#entrada").val('');
    });

    function extraer_ruts() {
      var rut_re = /\d{1,2}[.]?\d{3}[.]?\d{3}-[0-9kK]/g;

      var resultados = [], calce;
      var texto = $("#entrada").val();
      while ((calce = rut_re.exec(texto)) !== null) {
        resultados.push(calce[0]);
      }
      return resultados;
    }

    function normalizar_rut(rut) {
      return rut.replace(/[.]/g, '').replace('K', 'k')
    }

    $("#validar").on("click", function() {
      ruts = extraer_ruts();
      $.each(ruts, function (index, rut) {
        $("#reporte").html(function (i, old_html) {
          return old_html + '<br>' + normalizar_rut(rut);
        });
      });
    });

</script>

